{% extends "layout.html" %}

{% block title %}Edit {{ image.filename }}{% endblock %}

{% block content %}
<div class="edit-container">
    <h2>Edit Image Details</h2>
    
    <div class="image-preview">
        <img src="{{ url_for('static', filename='images/' + image.filename) }}" 
             alt="{{ image.description or 'Image for editing' }}">
    </div>

    <form method="POST" action="{{ url_for('images.update_image', image_id=image.id) }}">
        <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description" 
                      maxlength="500">{{ image.description or '' }}</textarea>
            <div class="char-count"><span id="desc-count">{{ image.description|length if image.description else 0 }}</span>/500</div>
        </div>

        <div class="tag-management">
            <h3>Tags</h3>
            <div class="current-tags">
                {% for tag in image.tags %}
                <span class="tag">
                    {{ tag.name }}
                    <a href="{{ url_for('images.remove_tag', image_id=image.id, tag_id=tag.id) }}" 
                       class="remove-tag">Ã—</a>
                </span>
                {% endfor %}
            </div>
            
            <div class="add-tag">
                <input type="text" id="new-tag" placeholder="Add new tag">
                <button type="button" id="add-tag-btn">Add</button>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-save">Save Changes</button>
            <a href="{{ url_for('images.gallery') }}" class="btn-cancel">Cancel</a>
        </div>
    </form>
</div>

{% block scripts %}
<script>
// Character count for description
document.getElementById('description').addEventListener('input', function() {
    document.getElementById('desc-count').textContent = this.value.length;
});

// Tag management JavaScript would go here
</script>
{% endblock %}
{% endblock %}